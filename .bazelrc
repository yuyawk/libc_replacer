# Set the cache location to local
startup --output_user_root=.cache/bazel

# Use bzlmod
common --enable_bzlmod

# For less error-prone testing
build --sandbox_default_allow_network=false
build --incompatible_strict_action_env
build --action_env=BAZEL_DO_NOT_DETECT_CPP_TOOLCHAIN=1
build --incompatible_enable_cc_toolchain_resolution
test --test_verbose_timeout_warnings

# For testing convenience
common --heap_dump_on_oom
test --test_output=errors

# For `hermetic_cc_toolchain`
common --enable_platform_specific_config
build:linux --sandbox_add_mount_pair=/tmp
build:macos --sandbox_add_mount_pair=/var/tmp
build:windows --sandbox_add_mount_pair=C:\Temp

# C compilation
build --copt -Wall
build --copt -Wextra
build --copt -Werror
build --copt -pedantic
build --copt -Wconversion
build --copt -Wcast-align
build --copt -Wunused
build --copt -Wshadow
build --copt -Wold-style-cast
build --copt -Wpointer-arith
build --copt -Wcast-qual
build --copt -Wmissing-prototypes
build --copt -Wno-missing-braces
build --conlyopt -std=c11
